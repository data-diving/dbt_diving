name: Run Tests
run-name: Build a test project and run tests
on:
  pull_request:
    branches: [main]

jobs:
  Run-Tests:
    runs-on: ubuntu-24.04
    steps:
      - name: Greeting Message
        run: echo "Running GitHub action to build and test projectâ€¦"
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Install uv
        run: curl -LsSf https://astral.sh/uv/install.sh | sh
      - name: Install Python & dbt
        working-directory: test_project
        run: uv venv && source .venv/bin/activate && uv pip install -r requirements.txt && export DBT_PROFILES_DIR=. && dbt deps
      - name: Run & test dbt
        working-directory: test_project
        run: source .venv/bin/activate && dbt run && dbt test && ./tests.sh
